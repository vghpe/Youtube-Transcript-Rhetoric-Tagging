<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text Highlighter & Filter</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 800px;
            margin: auto;
        }
        textarea {
            width: 100%;
            height: 150px;
            font-size: 14px;
            margin-bottom: 10px;
        }
        .highlight-box {
            padding: 10px;
            border: 1px solid #ccc;
            min-height: 100px;
            white-space: pre-wrap;
            background-color: #fafafa;
        }
        span {
            position: relative;
            cursor: pointer;
        }
        span::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background-color: black;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.2s ease-in-out;
        }
        span:hover::after {
            visibility: visible;
            opacity: 1;
        }
        
        /* Highlight colors */
        .fc { background-color: #b3e5fc; } /* Factual Claim */
        .sp { background-color: #d1c4e9; } /* Speculation */
        .el { background-color: #ffcdd2; } /* Emotive Language */
        .pl { background-color: #f8bbd0; } /* Pejorative Language */
        .ds { background-color: #ffeb3b; } /* Dismissive/Snarky */

        /* Filter panel */
        #filters {
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid #ccc;
            background-color: #eee;
        }
        #filters label {
            margin-right: 10px;
        }
    </style>
</head>
<body>

    <h2>Paste Tagged Text</h2>
    <textarea id="inputText" placeholder="Paste text with [TAG]...[/TAG] here"></textarea>
    <button onclick="highlightText()">Highlight</button>

    <h2>Filter by Tag</h2>
    <div id="filters">
        <label><input type="checkbox" class="filter-checkbox" value="fc" checked> Factual Claim [FC]</label>
        <label><input type="checkbox" class="filter-checkbox" value="sp" checked> Speculation [SP]</label>
        <label><input type="checkbox" class="filter-checkbox" value="el" checked> Emotive Language [EL]</label>
        <label><input type="checkbox" class="filter-checkbox" value="pl" checked> Pejorative Language [PL]</label>
        <label><input type="checkbox" class="filter-checkbox" value="ds" checked> Dismissive/Snarky [DS]</label>
    </div>

    <h2>Highlighted Output</h2>
    <div id="output" class="highlight-box"></div>

    <script>
        // Define tag mappings to CSS classes and tooltips
        const tagMap = {
            "FC": { class: "fc", tooltip: "Factual Claim (Verifiable fact)" },
            "SP": { class: "sp", tooltip: "Speculation (Guess or prediction)" },
            "EL": { class: "el", tooltip: "Emotive Language (Designed to provoke emotion)" },
            "PL": { class: "pl", tooltip: "Pejorative Language (Negative or insulting phrasing)" },
            "DS": { class: "ds", tooltip: "Dismissive/Snarky (Mocking, sarcastic, or exaggerated statement)" }
        };

        // Highlight tagged text
        function highlightText() {
            let text = document.getElementById("inputText").value;

            for (let tag in tagMap) {
                let regex = new RegExp(`\\[${tag}\\](.*?)\\[\\/${tag}\\]`, "gs");
                text = text.replace(regex, `<span class="${tagMap[tag].class}" data-tag="${tagMap[tag].class}" data-tooltip="${tagMap[tag].tooltip}">$1</span>`);
            }

            document.getElementById("output").innerHTML = text;
            applyFilters();
        }

        // Apply filtering based on checkboxes
        function applyFilters() {
            const checkboxes = document.querySelectorAll('.filter-checkbox');
            const visibleTags = {};
            checkboxes.forEach(chk => {
                visibleTags[chk.value] = chk.checked;
            });

            // Show/hide spans based on selected tags
            const spans = document.querySelectorAll('#output span');
            spans.forEach(span => {
                const tag = span.getAttribute('data-tag');
                if (visibleTags[tag]) {
                    span.style.display = "inline";
                } else {
                    span.style.display = "none";
                }
            });
        }

        // Add event listeners for filtering
        document.querySelectorAll('.filter-checkbox').forEach(chk => {
            chk.addEventListener('change', applyFilters);
        });
    </script>

</body>
</html>
